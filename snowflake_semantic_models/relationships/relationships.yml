# ============================================================================
# JAFFLE SHOP RELATIONSHIPS
# ============================================================================
# Defines how tables join together in the Jaffle Shop data model.
# Documentation: https://github.com/WhoopInc/snowflake-semantic-tools/blob/main/docs/semantic-models-guide.md

snowflake_relationships:
  # ===========================================================================
  # ORDERS RELATIONSHIPS
  # ===========================================================================
  
  # Orders to Customers
  # Each order belongs to exactly one customer
  - name: orders_to_customers
    left_table: {{ table('orders') }}
    right_table: {{ table('customers') }}
    relationship_conditions:
      - "{{ column('orders', 'customer_id') }} = {{ column('customers', 'customer_id') }}"

  # Orders to Locations
  # Each order is placed at exactly one location
  - name: orders_to_locations
    left_table: {{ table('orders') }}
    right_table: {{ table('locations') }}
    relationship_conditions:
      - "{{ column('orders', 'location_id') }} = {{ column('locations', 'location_id') }}"

  # ===========================================================================
  # ORDER ITEMS RELATIONSHIPS
  # ===========================================================================
  
  # Order Items to Orders
  # Each order item belongs to exactly one order
  - name: order_items_to_orders
    left_table: {{ table('order_items') }}
    right_table: {{ table('orders') }}
    relationship_conditions:
      - "{{ column('order_items', 'order_id') }} = {{ column('orders', 'order_id') }}"

  # Order Items to Products
  # Each order item references exactly one product
  - name: order_items_to_products
    left_table: {{ table('order_items') }}
    right_table: {{ table('products') }}
    relationship_conditions:
      - "{{ column('order_items', 'product_id') }} = {{ column('products', 'product_id') }}"

  # ===========================================================================
  # SUPPLIES RELATIONSHIPS
  # ===========================================================================
  
  # Supplies to Products
  # Each supply is associated with exactly one product
  - name: supplies_to_products
    left_table: {{ table('supplies') }}
    right_table: {{ table('products') }}
    relationship_conditions:
      - "{{ column('supplies', 'product_id') }} = {{ column('products', 'product_id') }}"

